/*
 *  SEOS CAmkES Interface for the RPC Server of the Crypto API
 *
 *  Copyright (C) 2019-2020, Hensoldt Cyber GmbH
 *
 */

procedure if_OS_Crypto {
    include "OS_Crypto.h";
    include "rpc/CryptoLibServer.h";

    // ---------------------------------- RNG ----------------------------------

    seos_err_t
    Rng_getBytes
    (
        in unsigned int flags,
        in size_t bufSize
    );
    seos_err_t
    Rng_reseed
    (
        in size_t seedLen
    );

    // ---------------------------------- MAC ----------------------------------

    seos_err_t
    Mac_init
    (
        inout CryptoLibMac_ptr pMacObj,
        in unsigned int algorithm
    );
    seos_err_t
    Mac_free
    (
        in CryptoLibMac_ptr macObj
    );
    seos_err_t
    Mac_exists
    (
        in CryptoLibMac_cptr macObj
    );
    seos_err_t
    Mac_start
    (
        in CryptoLibMac_ptr macObj,
        in size_t secretSize
    );
    seos_err_t
    Mac_process
    (
        in CryptoLibMac_ptr macObj,
        in size_t dataSize
    );
    seos_err_t
    Mac_finalize
    (
        in CryptoLibMac_ptr macObj,
        inout size_t macSize
    );

    // -------------------------------- Digest ---------------------------------

    seos_err_t
    Digest_init
    (
        inout CryptoLibDigest_ptr pDigestObj,
        in unsigned int algorithm
    );
    seos_err_t
    Digest_exists
    (
        in CryptoLibDigest_cptr digestObj
    );
    seos_err_t
    Digest_free
    (
        in CryptoLibDigest_ptr digestObj
    );
    seos_err_t
    Digest_clone
    (
        in CryptoLibDigest_ptr dstDigObj,
        in CryptoLibDigest_cptr srcDigObj
    );
    seos_err_t
    Digest_process
    (
        in CryptoLibDigest_ptr digestObj,
        in size_t inLen
    );
    seos_err_t
    Digest_finalize
    (
        in CryptoLibDigest_ptr digestObj,
        inout size_t digestSize
    );

    // --------------------------------- Key -----------------------------------

    seos_err_t
    Key_generate
    (
        inout CryptoLibKey_ptr pKeyObj
    );
    seos_err_t
    Key_makePublic
    (
        inout CryptoLibKey_ptr pPubKeyObj,
        in CryptoLibKey_cptr prvKeyObj
    );
    seos_err_t
    Key_import
    (
        inout CryptoLibKey_ptr pKeyObj
    );
    seos_err_t
    Key_export
    (
        in CryptoLibKey_cptr keyObj
    );
    seos_err_t
    Key_getParams
    (
        in CryptoLibKey_cptr keyObj,
        inout size_t paramSize
    );
    seos_err_t
    Key_getAttribs
    (
        in CryptoLibKey_cptr keyObj
    );
    seos_err_t
    Key_loadParams
    (
        in OS_CryptoKey_Param_t name,
        inout size_t paramSize
    );
    seos_err_t
    Key_exists
    (
        in CryptoLibKey_cptr keyObj
    );
    seos_err_t
    Key_free
    (
        in CryptoLibKey_ptr keyObj
    );

    // ------------------------------- Signature -------------------------------

    seos_err_t
    Signature_init
    (
        inout CryptoLibSignature_ptr pSigObj,
        in CryptoLibKey_cptr prvObj,
        in CryptoLibKey_cptr pubObj,
        in unsigned int algorithm,
        in unsigned int digest
    );
    seos_err_t
    Signature_verify (
        in CryptoLibSignature_ptr sigObj,
        in size_t hashSize,
        in size_t signatureSize
    );
    seos_err_t
    Signature_sign
    (
        in CryptoLibSignature_ptr sigObj,
        in size_t hashSize,
        inout size_t signatureSize
    );
    seos_err_t
    Signature_exists
    (
        in CryptoLibSignature_cptr sigObj
    );
    seos_err_t
    Signature_free
    (
        in CryptoLibSignature_ptr sigObj
    );

    // ----------------------------- Agreement ---------------------------------

    seos_err_t
    Agreement_init
    (
        inout CryptoLibAgreement_ptr pAgrObj,
        in CryptoLibKey_cptr prvObj,
        in unsigned int algorithm,
    );
    seos_err_t
    Agreement_agree
    (
        in CryptoLibAgreement_ptr agrObj,
        in CryptoLibKey_cptr pubObj,
        inout size_t sharedSize
    );
    seos_err_t
    Agreement_exists
    (
        in CryptoLibAgreement_cptr agrObj
    );
    seos_err_t
    Agreement_free
    (
        in CryptoLibAgreement_ptr agrObj
    );

    // -------------------------------- Cipher ---------------------------------

    seos_err_t
    Cipher_init
    (
        inout CryptoLibCipher_ptr pCipherObj,
        in CryptoLibKey_cptr keyObj,
        in unsigned int algorithm,
        in size_t ivLen
    );
    seos_err_t
    Cipher_exists
    (
        in CryptoLibCipher_cptr cipherObj
    );
    seos_err_t
    Cipher_free
    (
        in CryptoLibCipher_ptr cipherObj
    );
    seos_err_t
    Cipher_process
    (
        in CryptoLibCipher_ptr cipherObj,
        in size_t inLen,
        inout size_t outSize
    );
    seos_err_t
    Cipher_start
    (
        in CryptoLibCipher_ptr cipherObj,
        in size_t len
    );
    seos_err_t
    Cipher_finalize
    (
        in CryptoLibCipher_ptr cipherObj,
        inout size_t len
    );
};