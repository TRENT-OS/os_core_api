/*
 *  SEOS CAmkES Interface for the RPC Server of the Crypto API
 *
 *  Copyright (C) 2019-2020, Hensoldt Cyber GmbH
 *
 */

procedure seos_if_cryptoApi {
    include "SeosCryptoApi.h";
    include "SeosCryptoRpc_Server.h";

    // ---------------------------------- RNG ----------------------------------

    seos_err_t
    Rng_getBytes
    (
        in unsigned int flags,
        in size_t bufSize
    );
    seos_err_t
    Rng_reseed
    (
        in size_t seedLen
    );

    // ---------------------------------- MAC ----------------------------------

    seos_err_t
    Mac_init
    (
        inout SeosCryptoLib_Mac_Ptr pMacObj,
        in unsigned int algorithm
    );
    seos_err_t
    Mac_free
    (
        in SeosCryptoLib_Mac_Ptr macObj
    );
    seos_err_t
    Mac_exists
    (
        in SeosCryptoLib_Mac_CPtr macObj
    );
    seos_err_t
    Mac_start
    (
        in SeosCryptoLib_Mac_Ptr macObj,
        in size_t secretSize
    );
    seos_err_t
    Mac_process
    (
        in SeosCryptoLib_Mac_Ptr macObj,
        in size_t dataSize
    );
    seos_err_t
    Mac_finalize
    (
        in SeosCryptoLib_Mac_Ptr macObj,
        inout size_t macSize
    );

    // -------------------------------- Digest ---------------------------------

    seos_err_t
    Digest_init
    (
        inout SeosCryptoLib_Digest_Ptr pDigestObj,
        in unsigned int algorithm
    );
    seos_err_t
    Digest_exists
    (
        in SeosCryptoLib_Digest_CPtr digestObj
    );
    seos_err_t
    Digest_free
    (
        in SeosCryptoLib_Digest_Ptr digestObj
    );
    seos_err_t
    Digest_clone
    (
        in SeosCryptoLib_Digest_Ptr dstDigObj,
        in SeosCryptoLib_Digest_CPtr srcDigObj
    );
    seos_err_t
    Digest_process
    (
        in SeosCryptoLib_Digest_Ptr digestObj,
        in size_t inLen
    );
    seos_err_t
    Digest_finalize
    (
        in SeosCryptoLib_Digest_Ptr digestObj,
        inout size_t digestSize
    );

    // --------------------------------- Key -----------------------------------

    seos_err_t
    Key_generate
    (
        inout SeosCryptoLib_Key_Ptr pKeyObj
    );
    seos_err_t
    Key_makePublic
    (
        inout SeosCryptoLib_Key_Ptr pPubKeyObj,
        in SeosCryptoLib_Key_CPtr prvKeyObj
    );
    seos_err_t
    Key_import
    (
        inout SeosCryptoLib_Key_Ptr pKeyObj
    );
    seos_err_t
    Key_export
    (
        in SeosCryptoLib_Key_CPtr keyObj
    );
    seos_err_t
    Key_getParams
    (
        in SeosCryptoLib_Key_CPtr keyObj,
        inout size_t paramSize
    );
    seos_err_t
    Key_getAttribs
    (
        in SeosCryptoLib_Key_CPtr keyObj
    );
    seos_err_t
    Key_loadParams
    (
        in SeosCryptoApi_Key_Param name,
        inout size_t paramSize
    );
    seos_err_t
    Key_exists
    (
        in SeosCryptoLib_Key_CPtr keyObj
    );
    seos_err_t
    Key_free
    (
        in SeosCryptoLib_Key_Ptr keyObj
    );

    // ------------------------------- Signature -------------------------------

    seos_err_t
    Signature_init
    (
        inout SeosCryptoLib_Signature_Ptr pSigObj,
        in unsigned int algorithm,
        in unsigned int digest,
        in SeosCryptoLib_Key_CPtr prvObj,
        in SeosCryptoLib_Key_CPtr pubObj
    );
    seos_err_t
    Signature_verify (
        in SeosCryptoLib_Signature_Ptr sigObj,
        in size_t hashSize,
        in size_t signatureSize
    );
    seos_err_t
    Signature_sign
    (
        in SeosCryptoLib_Signature_Ptr sigObj,
        in size_t hashSize,
        inout size_t signatureSize
    );
    seos_err_t
    Signature_exists
    (
        in SeosCryptoLib_Signature_CPtr sigObj
    );
    seos_err_t
    Signature_free
    (
        in SeosCryptoLib_Signature_Ptr sigObj
    );

    // ----------------------------- Agreement ---------------------------------

    seos_err_t
    Agreement_init
    (
        inout SeosCryptoLib_Agreement_Ptr pAgrObj,
        in unsigned int algorithm,
        in SeosCryptoLib_Key_CPtr prvObj
    );
    seos_err_t
    Agreement_agree
    (
        in SeosCryptoLib_Agreement_Ptr agrObj,
        in SeosCryptoLib_Key_CPtr pubObj,
        inout size_t sharedSize
    );
    seos_err_t
    Agreement_exists
    (
        in SeosCryptoLib_Agreement_CPtr agrObj
    );
    seos_err_t
    Agreement_free
    (
        in SeosCryptoLib_Agreement_Ptr agrObj
    );

    // -------------------------------- Cipher ---------------------------------

    seos_err_t
    Cipher_init
    (
        inout SeosCryptoLib_Cipher_Ptr pCipherObj,
        in unsigned int algorithm,
        in SeosCryptoLib_Key_CPtr keyObj,
        in size_t ivLen
    );
    seos_err_t
    Cipher_exists
    (
        in SeosCryptoLib_Cipher_CPtr cipherObj
    );
    seos_err_t
    Cipher_free
    (
        in SeosCryptoLib_Cipher_Ptr cipherObj
    );
    seos_err_t
    Cipher_process
    (
        in SeosCryptoLib_Cipher_Ptr cipherObj,
        in size_t inLen,
        inout size_t outSize
    );
    seos_err_t
    Cipher_start
    (
        in SeosCryptoLib_Cipher_Ptr cipherObj,
        in size_t len
    );
    seos_err_t
    Cipher_finalize
    (
        in SeosCryptoLib_Cipher_Ptr cipherObj,
        inout size_t len
    );
};